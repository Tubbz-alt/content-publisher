<% content_for :back_link, render_back_link(href: document_path(@edition.document)) %>
<% content_for :title, t("tags.edit.title", title: @edition.title_or_fallback) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <p class="govuk-body"><%= t("tags.edit.description") %></p>

    <%= form_tag tags_path(@edition.document),
                 method: :patch,
                 data: {
                   "warn-before-unload": "true",
                   gtm: "confirm-edit-tags"
                 },
                 class: "app-c-contextual-guidance__form" do %>
      <% @edition.document_type.tags.each do |tag_field| %>
        <% if @edition.access_limit.present? && tag_field.id == "primary_publishing_organisation" %>
          <%= render "govuk_publishing_components/components/warning_text", {
            text: t("tags.edit.organisation_warning"),
          } %>
        <% end %>

        <div id="<%= tag_field.id %>">
          <%= render "tags/tags/#{tag_field.type}_input",
            tag_field: tag_field,
            tags: @revision.tags,
            issues: @issues %>
        </div>
      <% end %>

      <%= render "govuk_publishing_components/components/button", {
        text: "Save", margin_bottom: true
      } %>
    <% end %>
  </div>
</div>
